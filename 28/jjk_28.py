#!C:/KaizokuEncoderV2/python

from kaisen_common.sources import Source
from kaisen_common.filters import Filter
from kaisen_common.encoder import Encoder


OP = 1846
ED = 28363

src = Source(28)
SRC = src.merge(complex_ranges = [(OP+1136, OP+1611), (11299, 11359)])
SRC = src.replace('common/PV1.mkv', repl_start=1741, main_start=21053, duration=6)


flt = Filter(
    SRC,
    NO_AA_RANGES = [],
    NO_RESCALE_RANGES = [(7030, 7235), (12328, 12360), (27469, 27601)],
    NO_DENOISE_RANGES = [(7030, 7235), (12328, 12360), (27469, 27601), (10427, 10696), (16798, 16893), (19321, 19487), (22064, 22171), (27030, 27207)],
    STRONG_DEBAND_RANGES = [(ED, ED+92), (ED+1051, ED+1099), (11101, 11132)],
    DIMMED_SCENES = {
        (7672, 7695): 1.225,
        (7913, 7959): 1.1,
        (8092, 8151): 1.2,
        (8399, 8444): 1.2,
        (9133, 9134): 1.4,
        (9137, 9196): 1.225,
        (10032, 10077): 1.25,
        (10920, 10928): 1.225,
        (11092, 11132): 1.225,
        (11148, 11149): 1.225,
        (19321, 19335): 1.225,
        (19336, 19343): 2,
        (19344, 19373): 1.225,
        (20684, 20727): 1.225,
        (20809, 20853): 1.225,
        (21036, 21039): 1.1,
        (21040, 21052): 1.2,
        (21058, 21078): 1.225,
        (22196, 22324): 1.225,
        (22200, 22201): 1.4,
        (22219, 22220): 1.1,
        (22221, 22223): 1.2,
        (22380, 22382): 1.1,
        (22383, 22398): 1.2,
        (22397, 22398): 1.4,
        (22401, 22401): 1.5,
        (22402, 22407): 1.2,
        (22522, 22628): 1.225,
        (22665, 22721): 1.225,
        (22884, 23184): 1.225,
        (25480, 25482): 1.5,
        (25481, 25482): 1.5,
        (25483, 25484): 1.1,
        (25570, 25608): 1.614,
    },
    NUKE_FRAMES = [19337, 22397, 22399, 22593, 25481, 25484, 25570, 25572, 25574, 25576, 25578, 21059, 21058, 21060, 22401, 22402, 22404]
)

enc = Encoder(SRC, flt.process(ED3=ED))


if __name__ == '__main__':
    enc.run()
    enc.clean()
    enc.compare()
