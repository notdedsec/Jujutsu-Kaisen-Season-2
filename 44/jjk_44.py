#!C:/KaizokuEncoderV2/python

from kaisen_common.sources import Source
from kaisen_common.filters import Filter
from kaisen_common.encoder import Encoder


OP = 7336
ED = None

src = Source(44)
SRC = src.merge(complex_ranges = [(OP+647, OP+676), (OP+856, OP+905), (OP+1107, OP+1465), (OP+1497, OP+1536), (OP+1582, OP+1860), (OP+2026, OP+2157)])
SRC = src.replace('common/OP4.mkv', repl_start=1316, main_start=OP+1324, duration=4)


flt = Filter(
    SRC,
    NO_AA_RANGES = [],
    NO_RESCALE_RANGES = [],
    NO_DENOISE_RANGES = [(OP, OP+2157), (2858, 2899), (2948, 2983), (3026, 3055), (14295, 14498), (18560, 18637), (19468, 19631), (27364, 27525)],
    STRONG_DEBAND_RANGES = [(18734, 18741), (18993, 19042), (30003, 30020), (32550, 32933), (33054, 33113)],
    DIMMED_SCENES = {
        (3804, 3836): 1.4,
        (3849, 3891): 1.225,
        (3858, 3867): 2,
        (3868, 3869): 1.8,
        (3868, 3871): 1.5,
        (3872, 3874): 1.25,
        (13008, 13019): 1.4,
        (13104, 13136): 1.6,
        (17215, 17245): 1.5,
        (17217, 17218): 2,
        (17219, 17219): 1.2,
        (17220, 17245): 1.225,
        (17313, 17410): 1.4,
        (17519, 17590): 1.1,
        (18734, 18757): 1.4,
        (19187, 19187): 1.5,
        (19188, 19230): 4.5,
        (19231, 19258): 2.5,
        (19220, 19221): 2.5,
        (19223, 19224): 1.8,
        (19259, 19466): 1.4,
        (19284, 19285): 2,
        (19286, 19286): 1.25,
        (19355, 19466): 3,
        (25298, 25336): 1.69,
        (25328, 25460): 1.25,
        (25330, 25336): 1.15,
        (25581, 25622): 1.4,
        (26192, 26193): 4.5,
        (27364, 27525): 1.4,
        (28338, 28412): 1.15,
        (28413, 28526): 1.4,
        (28563, 28634): 1.6,
        (28635, 28669): 1.15,
        (29306, 29332): 1.2,
        (29324, 29326): 2.55,
        (29969, 29994): 1.1,
        (30003, 30019): 2.5,
        (30007, 30019): 2,
        (30010, 30011): 1.225,
        (30014, 30017): 1.225,
        (30020, 30480): 1.25,
        (30127, 30210): 1.38,
        (30211, 30294): 1.32,
        (30292, 30293): 1.25,
        (30364, 30368): 1.5,
        (30366, 30366): 1.25,
        (30400, 30480): 1.1,
        (30481, 30645): 1.225,
        (30817, 30817): 1.05,
        (30818, 30818): 1.1,
        (30819, 30819): 1.2,
        (30820, 30820): 1.25,
        (30821, 30821): 1.5,
        (30822, 30822): 2,
        (30823, 30823): 2.25,
        (30824, 30824): 2.35,
        (30825, 30948): 2.45,
        (31129, 31243): 1.4,
        (31246, 31323): 2.5,
        (31246, 31248): 1.5,
        (31247, 31247): 1.2,
        (31309, 31323): 1.5,
        (31290, 31293): 1.2,
        (31423, 31464): 1.45,
        (31489, 31528): 1.15,
        (32328, 32432): 1.1,
        (32328, 32332): 1.1,
        (32469, 32516): 1.1,
        (32469, 32474): 1.15,
        (32517, 32759): 1.6,
        (32549, 32759): 1.2,
        (32760, 32801): 1.225,
        (32802, 32885): 1.8,
        (32802, 32843): 1.25,
        (32857, 32885): 1.2,
        (32893, 32898): 1.1,
        (32899, 32933): 1.25,
        (32906, 32933): 1.15,
        (32911, 32933): 1.1,
        (33054, 33113): 1.4,
        (33261, 33332): 1.35,
    },
    NUKE_FRAMES = [
        3858, 3859, 3862, 3864, 3866, 3868, 17210, 17213, 17215, 17217, 17224, 17227, 17230, 17233, 17236, 17239, 17242, 17244,
        18742, 19188, 19195, 19197, 19199, 19204, 19206, 19208, 19210, 19213, 19215, 19217, 19220, -19224, 19284, 19355, 25300, 25302,
        25305, 25308, 25311, 25314, 25316, -25322, 26192, 26194, -30002, 30005, 30007, 30010, -30013, 30014, -30019, -30367, -33262
    ] \
    + [x for x in range(30826, 30898) if x % 2 != 1 and x not in [30846, 30860, 30862]]
)

enc = Encoder(SRC, flt.process())


if __name__ == '__main__':
    enc.run()
    enc.clean()
    enc.compare()
